# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —ç–∫—Å–ø–æ—Ä—Ç—É —Ç–∞–±–µ–ª—è —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

–ú–æ–¥—É–ª—å —Ç–∞–±–µ–ª—è —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç –≤ –¥–≤–∞ —Ñ–æ—Ä–º–∞—Ç–∞:
- **Excel (.xlsx)** - —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, —Å—Ç–∏–ª—è–º–∏ –∏ —Ñ–æ—Ä–º—É–ª–∞–º–∏
- **PDF** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –ø–µ—á–∞—Ç–∏ –≤ –∞–ª—å–±–æ–º–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –≤–∞—à `.env` —Ñ–∞–π–ª:

```env
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Ç–∞–±–µ–ª—è
WORK_HOURS_PER_DAY=8
WORK_START_TIME=09:00
WORK_TIMEZONE=Europe/Moscow
WEEKEND_DAYS=6,0
SERVICE_START_DATE=2025-01-01
```

### –û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

- `WORK_HOURS_PER_DAY` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—á–∏—Ö —á–∞—Å–æ–≤ –≤ –¥–µ–Ω—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8)
- `WORK_START_TIME` - –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 09:00)
- `WORK_TIMEZONE` - —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é Europe/Moscow)
- `WEEKEND_DAYS` - –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –≤—ã—Ö–æ–¥–Ω—ã–º–∏ (0=–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, 6=–°—É–±–±–æ—Ç–∞)
- `SERVICE_START_DATE` - –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –º–æ–¥—É–ª—å "–¢–∞–±–µ–ª—å —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏"
2. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –º–µ—Å—è—Ü –∏ –≥–æ–¥
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üìä Excel** –∏–ª–∏ **üìÑ PDF** –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
4. –§–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ

### API Endpoints

#### –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
```
GET /api/timesheet/export/excel
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `object_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - ID –æ–±—ä–µ–∫—Ç–∞
- `year` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –≥–æ–¥
- `month` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –º–µ—Å—è—Ü (1-12)

#### –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF
```
GET /api/timesheet/export/pdf
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `object_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - ID –æ–±—ä–µ–∫—Ç–∞
- `year` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –≥–æ–¥
- `month` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –º–µ—Å—è—Ü (1-12)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### Excel —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–∞ –∏ –ø–µ—Ä–∏–æ–¥–æ–º
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- –¢–∞–±–ª–∏—Ü—É —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É
- –ò—Ç–æ–≥–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –ø–æ –≤—Å–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º
- –¶–≤–µ—Ç–æ–≤–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–Ω–µ–π

### PDF —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–ª—è –ø–µ—á–∞—Ç–∏
- –ê–ª—å–±–æ–º–Ω—É—é –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —à—Ä–∏—Ñ—Ç –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ

## –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã** - –º–æ–≥—É—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–µ–ª–∏ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- **–û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** - –º–æ–≥—É—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Ç–∞–±–µ–ª–∏

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `maatwebsite/excel` - –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel
- `dompdf/dompdf` - –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ PDF

### –§–∞–π–ª—ã
- `app/Exports/TimesheetExport.php` - –∫–ª–∞—Å—Å —ç–∫—Å–ø–æ—Ä—Ç–∞ Excel
- `app/Http/Controllers/TimesheetController.php` - –º–µ—Ç–æ–¥—ã —ç–∫—Å–ø–æ—Ä—Ç–∞
- `resources/js/components/Timesheet.vue` - –∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### –§–æ—Ä–º–∞—Ç—ã –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤
- Excel: `timesheet_{ObjectName}_{Month}_{Year}.xlsx`
- PDF: `timesheet_{ObjectName}_{Month}_{Year}.pdf`

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ "Class not found"
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
composer require maatwebsite/excel
composer require dompdf/dompdf
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –≤ PDF
PDF –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —à—Ä–∏—Ñ—Ç DejaVu Sans –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã. –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ DomPDF.

### –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã Excel
–î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥–∏ Laravel:
```php
// –í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
return Excel::queue(new TimesheetExport(...), 'filename.xlsx');
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞
–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å:
- –°—Ç–∏–ª–∏ –≤ `TimesheetExport.php`
- HTML —à–∞–±–ª–æ–Ω PDF –≤ –º–µ—Ç–æ–¥–µ `generateTimesheetHtml()`
- –õ–æ–≥–∏–∫—É —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –º–µ—Ç–æ–¥–µ `getTimesheetData()`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Export –∫–ª–∞—Å—Å –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä. 